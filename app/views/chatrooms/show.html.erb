<% content_for :nav, render('shared/chat-show-top') %>

<!-- CHATROOM -->
<div class="container">

  <div id="messages" data-chatroom-id="<%= @chatroom.id %>">
    <% @chatroom.messages.each do |message| %>

      <!-- applying a class on a div if the user is current_user -->
      <div class="chatroom d-flex <%= "sender" if message.user == current_user %> ">

        <% unless message.user == current_user %>
          <%= cl_image_tag current_user.photo.attached? ? current_user.photo.key : "avatar_lrtyy7", class: "avatar-mini bottom" %>
        <% end %>
        <div class="message-container" id="message-<%= message.id %>">
          <i class="author">
            <span><%= message.user.name %></span>
            <small><%= format_message_time(message.created_at) %></small>
          </i>
          <p><%= message.content %></p>
        </div>

        <% if message.user == current_user %>
          <%= cl_image_tag current_user.photo.attached? ? current_user.photo.key : "avatar_lrtyy7", class: "avatar-mini bottom" %>
        <% end %>

      </div>
    <% end %>
  </div>

</div>

<!-- bottom send-message -->
<div style="height: 120px"></div>
<div class="container chat-border-top">
  <div>
    <%= simple_form_for [ @chatroom, @message ], remote: true do |f| %>
      <%= f.input :content, label: false, placeholder: "Your message.." %>
      <%= f.submit 'Send', class:"small-transparent-btn mt-2" %>
    <% end %>
  </div>
</div>
